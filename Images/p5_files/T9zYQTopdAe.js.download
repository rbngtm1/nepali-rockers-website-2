if (self.CavalryLogger) { CavalryLogger.start_js(["xqzm6"]); }

__d("SearchFiltersPageLoader",["XUISubNavigation"],(function a(b,c,d,e,f,g){"use strict";var h={onPageTransition:function i(){c("XUISubNavigation").skipNextTransition()}};f.exports=h}),null);
__d("BrowseLinkType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({RESULT_PERMALINK:"result_permalink",MODULE_ENDPOINT:"module_endpoint",EXPAND_INLINE:"expand_inline",MODAL:"modal"})}),null);
__d("XAsyncSearchInlineExpandStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/search/async/expand_story/",{story_token:{type:"String"},has_snippet:{type:"Bool",defaultValue:false},unicorn_story_id:{type:"String"},browse_location:{type:"String",defaultValue:"browse_location:browse"},expand_comments:{type:"Bool",defaultValue:false}})}),null);
__d("XAsyncSearchStoryModalViewController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/search/async/story_modal/",{browse_location:{type:"String",defaultValue:"browse_location:browse"},story_token:{type:"String",required:true},unicorn_story_id:{type:"String",required:true},link_type:{type:"String",defaultValue:"modal"},expand_comments:{type:"Bool",defaultValue:false}})}),null);
__d("DenseStoryInlineExpansion",["csx","cx","AsyncRequest","BanzaiODS","Bootloader","BrowseLinkType","CSS","DOM","Event","Parent","XAsyncSearchInlineExpandStoryController","XAsyncSearchStoryModalViewController","tidyEvent"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j={addListenerForClick:function k(l,m){__p&&__p();var n=false;c("tidyEvent")(c("Event").listen(l,"click",function(event){var o=event.target;if(n&&!this.isModal(m)||this.isClickToNewWindow(event)||o instanceof HTMLElement&&this.isClickOnHeaderEntity(o))return;n=true;event.preventDefault();event.stopPropagation();if(this.isModal(m))this.handleModalClick(m,event);else this.handleInlineExpansionClick(m,event)}.bind(this)))},handleModalClick:function k(l,event){var m=event.target,n=this.shouldExpandComments(m);c("Bootloader").loadModules(["AsyncDialog"],function(o){var p=c("XAsyncSearchStoryModalViewController").getURIBuilder().setString("story_token",l.storyToken).setString("unicorn_story_id",l.unicornStoryID).setString("browse_location",l.browseLocation).setBool("expand_comments",n).getURI();o.send(new(c("AsyncRequest"))(p))},"DenseStoryInlineExpansion")},handleInlineExpansionClick:function k(l,event){var m=l.snippetElem,n=m!=null,o=event.target,p=this.shouldExpandComments(o);c("DOM").replace(l.storyElem,l.placeholderElem);var q=c("XAsyncSearchInlineExpandStoryController").getURIBuilder().setString("story_token",l.storyToken).setBool("has_snippet",n).setString("unicorn_story_id",l.unicornStoryID).setString("browse_location",l.browseLocation).setBool("expand_comments",p).getURI();c("BanzaiODS").bumpEntityKey("search_story_expansion","render_attempt");new(c("AsyncRequest"))().setURI(q).setHandler(function(r){c("DOM").replace(l.placeholderElem,r.payload);if(m!=null)c("CSS").addClass(m,"_1nlc")}).setErrorHandler(function(r){c("BanzaiODS").bumpEntityKey("search_story_expansion","render_failure")}).send()},isModal:function k(l){return l.linkType===c("BrowseLinkType").MODAL},shouldExpandComments:function k(l){if(!(l instanceof HTMLElement))return false;var m=c("Parent").bySelector(l,"._-56");return m!=null},isClickOnHeaderEntity:function k(l){var m=c("Parent").bySelector(l,"._vwp")||c("Parent").byClass(l,"profileLink");return m!=null},isClickToNewWindow:function k(event){return event.ctrlKey||event.metaKey}};f.exports=j}),null);