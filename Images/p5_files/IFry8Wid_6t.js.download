if (self.CavalryLogger) { CavalryLogger.start_js(["xMDdM"]); }

__d("MercuryJewelCountControl",["Arbiter","MercuryDispatcher","MercuryThreadInformer","MercuryUnseenState","UserActivity","isInFocusMode"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";__p&&__p();var j=c("MercuryDispatcher").get(),k=c("MercuryThreadInformer").get();this.$MercuryJewelCountControl2=c("MercuryUnseenState").get();this.render();j.subscribe("model-update-completed",function(l,m){this.$MercuryJewelCountControl3(false)}.bind(this));k.subscribe("unseen-updated",function(){return this.render()}.bind(this));this.$MercuryJewelCountControl1=i;this.$MercuryJewelCountControl1.subscribe("marked-seen",function(){this.$MercuryJewelCountControl3(true)}.bind(this))}h.prototype.render=function(){"use strict";var i=c("isInFocusMode")()?0:this.$MercuryJewelCountControl2.getUnseenCount();c("Arbiter").inform("jewel/count-updated",{jewel:"mercurymessages",count:i},c("Arbiter").BEHAVIOR_STATE)};h.prototype.$MercuryJewelCountControl3=function(i){"use strict";if(i||this.$MercuryJewelCountControl1.isOpen()&&c("UserActivity").isActive())this.$MercuryJewelCountControl2.markAsSeen()};h.constructStores=function(){"use strict";c("MercuryUnseenState").get()};f.exports=h}),null);
__d("MercuryJewelThreadlistControl",["csx","cx","fbt","ArbiterMixin","CurrentUser","CSS","DOM","Event","JSLogger","JewelLogger","MercuryConfig","MercuryMessengerJewelPerfConfig","MercuryFilters","MercuryThreadlistConstants","MercuryThreadlistContainer.react","MessagesJewelThreadList.react","MessagingTag","MessengerURIConstants","performanceNowNoFallback","React","ReactDOM","MercuryThreadInformer","MercuryUnreadState","mixin","gkx"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=c("JewelLogger").logDataEagerLoad,n=c("JSLogger").create("mercury_jewel"),o=c("MessagingTag").PENDING,p="back_to_inbox",q=j._("See All in Messenger"),r=c("MercuryMessengerJewelPerfConfig").logJewelData&&c("performanceNowNoFallback");k=babelHelpers.inherits(s,c("mixin")(c("ArbiterMixin")));l=k&&k.prototype;function s(t){"use strict";__p&&__p();l.constructor.call(this);this.$JewelThreadlistControl19=function(v,w){v.preventDefault();this.$JewelThreadlistControl1=w;var x=this.$JewelThreadlistControl3;if(this.$JewelThreadlistControl6[x])c("CSS").removeClass(this.$JewelThreadlistControl6[x],"_1sdd");this.$JewelThreadlistControl8=false;this.$JewelThreadlistControl3="aggregation";this.render()}.bind(this);this.$JewelThreadlistControl17=function(v){v.preventDefault();this.$JewelThreadlistControl9(c("MessagingTag").PENDING,c("MercuryFilters").ALL)}.bind(this);this.$JewelThreadlistControl18=function(v){v.preventDefault();this.$JewelThreadlistControl9(c("MessagingTag").OTHER,c("MercuryFilters").ALL)}.bind(this);var u=t.getFlyout();this.$JewelThreadlistControl1=[];this.$JewelThreadlistControl2=c("DOM").find(u,"._3v_l");this.$JewelThreadlistControl3=c("MessagingTag").INBOX;this.$JewelThreadlistControl4=c("MercuryFilters").ALL;this.$JewelThreadlistControl5=c("CurrentUser").getID();this.$JewelThreadlistControl6={};this.$JewelThreadlistControl7={};this.$JewelThreadlistControl6[c("MessagingTag").INBOX]=c("DOM").find(u,"._1sde");this.$JewelThreadlistControl7[c("MessagingTag").INBOX]=c("DOM").find(u,"._1sdg");this.$JewelThreadlistControl8=false;c("Event").listen(this.$JewelThreadlistControl6[c("MessagingTag").INBOX],"click",function(){return this.$JewelThreadlistControl9(c("MessagingTag").INBOX,c("MercuryFilters").ALL)}.bind(this));if(!c("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")){this.$JewelThreadlistControl6[o]=c("DOM").find(u,"._1sdf");this.$JewelThreadlistControl7[o]=c("DOM").find(u,"._1sdh");c("Event").listen(this.$JewelThreadlistControl6[o],"click",function(){return this.$JewelThreadlistControl9(o,c("MercuryFilters").ALL)}.bind(this))}else{this.$JewelThreadlistControl6[p]=c("DOM").find(u,"._34zq");c("Event").listen(this.$JewelThreadlistControl6[p],"click",function(){return this.$JewelThreadlistControl9(c("MessagingTag").INBOX,c("MercuryFilters").ALL)}.bind(this))}this.$JewelThreadlistControl10=c("DOM").find(u,"._1c1m");this.$JewelThreadlistControl11=c("DOM").find(u,"._4djt");this.$JewelThreadlistControl12=c("MercuryUnreadState").get();c("Event").listen(this.$JewelThreadlistControl10,"click",function(v){this.$JewelThreadlistControl13();v.kill()}.bind(this));c("MercuryThreadInformer").get().subscribe("unread-updated",function(){return this.$JewelThreadlistControl14()}.bind(this));this.$JewelThreadlistControl14();this.render();n.bump("opened_threadlist_"+this.$JewelThreadlistControl3)}s.prototype.render=function(){"use strict";c("ReactDOM").render(c("React").createElement(c("MercuryThreadlistContainer.react"),{ChildClass:c("MessagesJewelThreadList.react"),folder:this.$JewelThreadlistControl3,filter:this.$JewelThreadlistControl4,jewelRequestsUI:c("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h"),viewer:this.$JewelThreadlistControl5,onDataFetchStart:this.$JewelThreadlistControl15,onDataFetchEnd:this.$JewelThreadlistControl16,onMessageRequestsClick:this.$JewelThreadlistControl17,onFilteredRequestsClick:this.$JewelThreadlistControl18,onAggregationClick:this.$JewelThreadlistControl19,resetAggregatedThreads:this.$JewelThreadlistControl8,threadIDs:this.$JewelThreadlistControl1,threadCount:c("MercuryMessengerJewelPerfConfig").initialThreadCount}),this.$JewelThreadlistControl2)};s.prototype.$JewelThreadlistControl15=function(){"use strict";r&&m({jewelName:"mercurymessages",eventName:"data_eager_load_start",timestamp:c("performanceNowNoFallback")()})};s.prototype.$JewelThreadlistControl16=function(){"use strict";r&&m({jewelName:"mercurymessages",eventName:"data_eager_load_end",timestamp:c("performanceNowNoFallback")()})};s.prototype.$JewelThreadlistControl13=function(){"use strict";this.$JewelThreadlistControl12.markFolderAsRead(this.$JewelThreadlistControl3)};s.prototype.$JewelThreadlistControl9=function(t,u){"use strict";__p&&__p();this.$JewelThreadlistControl8=true;this.$JewelThreadlistControl1=[];if(this.$JewelThreadlistControl3!==t||this.$JewelThreadlistControl4!==u){var v=this.$JewelThreadlistControl3,w=t===c("MessagingTag").INBOX,x=t;n.bump("opened_threadlist_"+t);if(this.$JewelThreadlistControl6[x])c("CSS").addClass(this.$JewelThreadlistControl6[x],"_1sdd");if(this.$JewelThreadlistControl6[v])c("CSS").removeClass(this.$JewelThreadlistControl6[v],"_1sdd");this.$JewelThreadlistControl3=t;this.$JewelThreadlistControl4=u;if(w){this.$JewelThreadlistControl11.href=c("MessengerURIConstants").FACEBOOK_PREFIX;this.$JewelThreadlistControl11.text=q;this.$JewelThreadlistControl5=c("CurrentUser").getID()}else if(t==o){this.$JewelThreadlistControl11.href=c("MessengerURIConstants").FACEBOOK_PREFIX+c("MessengerURIConstants").MESSAGE_REQUESTS_PATH;this.$JewelThreadlistControl11.text=q;this.$JewelThreadlistControl5=c("CurrentUser").getID()}if(c("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h")){c("CSS").conditionShow(this.$JewelThreadlistControl6[c("MessagingTag").INBOX],w);c("CSS").conditionShow(this.$JewelThreadlistControl6[p],!w)}this.render()}};s.prototype.$JewelThreadlistControl14=function(){"use strict";this.$JewelThreadlistControl20(c("MessagingTag").INBOX);if(!c("gkx")("AT6h5--3KUdxbat1rL4n2mVcPcg9eZ8bwokXjpPZS-_sSShoFlPyHXdioNqIwODAz2vH7270MK0r4x8XFkaYt6-h"))this.$JewelThreadlistControl20(o)};s.prototype.$JewelThreadlistControl20=function(t){"use strict";var u=void 0;if(this.$JewelThreadlistControl12.exceedsMaxCount(t))u=c("MercuryThreadlistConstants").MAX_UNREAD_COUNT;else u=this.$JewelThreadlistControl12.getUnreadCount(t);this.$JewelThreadlistControl21(u,t)};s.prototype.$JewelThreadlistControl21=function(t,u){"use strict";__p&&__p();var v=this.$JewelThreadlistControl7[u];if(!v)return;var w=t?t.toString():0;if(t>0){if(t==c("MercuryThreadlistConstants").MAX_UNREAD_COUNT)w+="+";c("DOM").setContent(v,j._("({unread_count})",[j.param("unread_count",w)]))}else c("DOM").setContent(v,"")};f.exports=s}),null);
__d("MercuryJewel",["Arbiter","EventProfiler","MercuryJewelCountControl","MercuryMessengerJewelPerfConfig","MercuryServerPayloadPreprocessor"],(function a(b,c,d,e,f,g){__p&&__p();var h=false,i=false,j=null;function k(l,m){"use strict";__p&&__p();c("MercuryJewelCountControl").constructStores();c("MercuryServerPayloadPreprocessor").get().handleUpdate(m);this.$MercuryJewel1=new(c("MercuryJewelCountControl"))(l);l.subscribeOnce("opened",function(){this.$MercuryJewel2(l)}.bind(this));l.subscribeOnce("user-open",function(){this.$MercuryJewel3(l)}.bind(this));if(c("MercuryMessengerJewelPerfConfig").eagerLoadingOnBadge)l.subscribe("updated",function(n,o){if(o&&o.count>0)this.$MercuryJewel2(l)}.bind(this))}k.prototype.$MercuryJewel2=function(l){"use strict";__p&&__p();this.$MercuryJewel3(l);if(!h){h=true;if(!l.isOpen())j=c("EventProfiler").notifyRunningEagerInteraction(["Messages_Jewel_Button"],"click");e(["MercuryJewelThreadlistControl"],function(m){this.$MercuryJewel4=new m(l)}.bind(this));c("Arbiter").inform("mercury-jewel/opened",null,c("Arbiter").BEHAVIOR_STATE)}};k.prototype.$MercuryJewel3=function(l){"use strict";if(!i&&l.isOpen()){i=true;c("EventProfiler").tagCurrentActiveInteractionsAs("FirstMercuryJewelOpen");if(j)j()}};f.exports=k}),null);